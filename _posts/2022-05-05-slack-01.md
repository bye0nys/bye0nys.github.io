---
title: "(Slack API, DRF) Djangoì™€ Slack APIë¥¼ ì—°ë™í•˜ì—¬ ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ / ì—ëŸ¬ ë¡œê¹… ë´‡ ë§Œë“¤ê¸°"

categories:
   - study

tags:
   - study
   - Backend
   - python
   - django
   - API
   - Slack

comments: true
toc: true
toc_sticky: true

date: 2022-05-05 17:56 +0900
last_modified_at: 2022-05-05 17:56 +0900
---

***Slack***ì€ ì°¸ ë‹¤ì–‘í•œ, ë§ì€ ë¶„ì•¼ì—ì„œ ì´ìš©ëœë‹¤. íšŒì‚¬ì˜ *ì‚¬ë‚´ ë©”ì‹ ì €*, *í˜‘ì—… íˆ´*, *ë§ˆì¼€íŒ… ë„êµ¬*, í˜¹ì€ *ë°±ì˜¤í”¼ìŠ¤* ë“± ë¬´ê¶ë¬´ì§„í•œ ì“°ì„ìƒˆê°€ ìˆë‹¤.<br><br>
ì´ëŸ¬í•œ ìœ ì €ë“¤ì˜ ë‹ˆì¦ˆì— ê±¸ë§ê²Œ, Slackì—ì„œëŠ” ìƒë‹¹íˆ ë§ì€ ì¢…ë¥˜ì˜ í†µí•©ì„ ì œê³µí•œë‹¤.<br>
ë‚˜ë„ íšŒì‚¬ ì—…ë¬´ë¥¼ í•˜ë©° ì—¬ëŸ¬ ë²ˆì˜ í†µí•©ì„ ì§„í–‰í–ˆê³ , ê·¸ ë¶€ë¶„ë“¤ì„ ê¹Œë¨¹ì§€ ì•Šê³ ì í¬ìŠ¤íŒ…í•´ë³´ë ¤ê³  í•œë‹¤.<br><br>
ë‚´ê°€ ì§„í–‰í–ˆë˜ ë¶€ë¶„ì„ í¬ê²Œ ë‘ ê°€ì§€ë¡œ ë‚˜ëˆ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.
1. ***Slack API***ë¥¼ í™œìš©í•œ *Django ì—ëŸ¬ ë¡œê¹… ë´‡* ìƒì„±
2. ***Github Webhook***ì„ í™œìš©í•œ Commit/Push/PR/Merge ë¡œê¹…

ì˜¤ëŠ˜ì€ ë¨¼ì € 1ë²ˆì¸ *Slack API*ì™€ *ì—ëŸ¬ ë¡œê¹…*ì— ëŒ€í•´ ë§í•´ë³´ë ¤ê³  í•œë‹¤.
<br><br>

# 1. __Slack API__
ë¨¼ì € [*Slack API*](https://api.slack.com/docs)ëŠ”, ì´ë¦„ì—ì„œ ì•Œ ìˆ˜ ìˆë‹¤ì‹œí”¼ Slackì˜ ì—¬ëŸ¬ ê°€ì§€ ê¸°ëŠ¥ë“¤ì„ API Callì„ í†µí•´ ì†ì‰½ê²Œ í™œìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ë‹¤.<br><br>
API Callê¹Œì§€ì˜ ë°©ë²•ì€ ëŒ€ëµì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ë‹¤.<br>
1. Slackìœ¼ë¡œë¶€í„° ***Access Token (OAuth)***ë¥¼ ë°œê¸‰ë°›ëŠ”ë‹¤.
2. Access Tokenì„ í†µí•´ ***ì¸ì¦***ì„ ì§„í–‰í•œë‹¤.
3. ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” ê¸°ëŠ¥ì— ë§ê²Œ *HTTP GET/POST* ë¥¼ ë³´ë‚¸ë‹¤. (ìœ„ì˜ docs ì°¸ê³ )
4. ì‘ë‹µì„ ë°›ì€ í›„ ì ì ˆíˆ ì²˜ë¦¬í•œë‹¤.

<br>
1ë¶€í„° ì§„í–‰í•´ ë³´ì. ë¨¼ì € ë‚˜ëŠ” 1ì˜ ê³¼ì •ê³¼ ë©”ì‹œì§€ ì „ì†¡ì„ ëŒ€ì‹ í•´ ì£¼ëŠ” ë´‡ì„ ë§Œë“¤ê³  ì‹œì‘í•  ì˜ˆì •ì´ë‹¤.<br><br>
í†µí•©í•˜ê³ ì í•˜ëŠ” ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì—ì„œ ë´‡ì„ ë§Œë“¤ì–´ ë³´ì. [*apps ë§í¬*](https://api.slack.com/apps)
<br>

1. Create New Appì„ ëˆ„ë¥´ê³ ,
2. ì ë‹¹íˆ ì´ë¦„ì„ (ex: notiBot? ì´ë¼ë˜ì§€..) ì§€ì–´ì¤€ í›„
3. features and functionalityë¥¼ Botsìœ¼ë¡œ ì„¤ì •í•œë‹¤.
4. ë§ˆì§€ë§‰ìœ¼ë¡œ Scopeë¥¼ ì ì ˆíˆ ì„¤ì •í•˜ë©´ ëœë‹¤.<br> -> ë‹¨ìˆœ ë©”ì‹œì§€ ì „ì†¡ë§Œ ì§„í–‰í•˜ë ¤ê³  í•˜ë¯€ë¡œ chat:writeë§Œì„ ì„¤ì •í•´ ì¤€ë‹¤.

<br>
install to workspaceë¥¼ ì§„í–‰í•˜ë©´ *Access Token*ì´ ë°œê¸‰ë˜ëŠ”ë°, ì¤‘ìš”í•œ í† í°ì´ë‹ˆ ì ì‹œ ë©”ëª¨ì¥ ê°™ì€ ê³³ì— ì €ì¥í•´ ë‘ì..<br><br>
ì´í›„ ì•±ì— ë´‡ì„ ì¶”ê°€í•´ì£¼ì

![image](https://drive.google.com/uc?id=1-W435Rib0T_MvNVekMui09sddvTHQZ4j)
<br>

ì—¬ê¸°ê¹Œì§€ ì„±ê³µì ìœ¼ë¡œ ì§„í–‰í–ˆë‹¤ë©´, ì´ì œ í˜•ì‹ì— ë§ê²Œ request bodyë¥¼ ë§Œë“¤ì–´ ë³´ì.
<br/><br/>

# 2. Django ì—ì„œì˜ ì„¤ì •
ë¨¼ì € ë‚˜ëŠ” *Django Rest Framework*ë¥¼ í™œìš©í•´ APIê°œë°œì„ ì§„í–‰í•˜ê³  ìˆë‹¤. ì •ë§ í¸í•˜ê²Œë„ Slack APIëŠ” íŒŒì´ì¬ì˜ íŒ¨í‚¤ì§€ ê´€ë¦¬ìì¸ pipìœ¼ë¡œ ì†ì‰½ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.<br><br>
python ê°€ìƒ í™˜ê²½ì„ ì‹¤í–‰í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì.<br>

~~~
pip install slackclient
~~~

<br>
ì–´ì©Œê³  ì €ì©Œê³  Success~ê°€ ëœ¨ê³  ì„¤ì¹˜ê°€ ì™„ë£Œë˜ë©´, ì´í›„ ì´ë¥¼ í™œìš©í•˜ê³ ì í•˜ëŠ” ê³³ì—ì„œ ì•„ë˜ì™€ ê°™ì´ ëª¨ë“ˆì„ importí•´ ì£¼ì.

~~~
from slack import WebClient
~~~

<br>
ì´í›„ *WebClient*ì—ì„œ ìš”êµ¬í•˜ëŠ” ëŒ€ë¡œ bodyë¥¼ ì‘ì„±í•´ ì£¼ì.<br>
ë‚˜ì˜ ê²½ìš°ì—” *celery*ë¥¼ í†µí•œ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ì¶”ê°€í–ˆì§€ë§Œ, ì´ ë¶€ë¶„ì€ ë³¸ì¸ì´ ì‚¬ìš©í•˜ëŠ” êµ¬ì¡°ì— ë§ê²Œ ê±´ë„ˆë›°ê±°ë‚˜ í•˜ì.<br><br>

ëŒ€ëµì ìœ¼ë¡œ postí•˜ëŠ” ë¶€ë¶„ì„ ì§œë³´ìë©´ ì•„ë˜ì™€ ê°™ë‹¤.<br/>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;slack&nbsp;<span style="color:#a71d5d">import</span>&nbsp;WebClient</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;somewhere_app_exists&nbsp;<span style="color:#a71d5d">import</span>&nbsp;app</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;somewhere_secret_exists&nbsp;<span style="color:#a71d5d">import</span>&nbsp;slack_api_access_token,&nbsp;slack_post_channel_url</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">@app.task(ignore_result<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#066de2">True</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">def</span>&nbsp;slack_error_post(<span style="color:#0086b3"></span><span style="color:#a71d5d">*</span><span style="color:#0086b3"></span><span style="color:#a71d5d">*</span>kwargs):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;client&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;WebClient(token<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>slack_api_token)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;body_raw&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;{from_somewhere}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">try</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client.chat_postMessage(</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;channel&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;slack_post_channel_url,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blocks&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;json.dumps(body_raw)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">except</span>&nbsp;Exception:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">pass</span></div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div><br>

* 3ë²ˆì§¸ ì¤„ì˜ appì€ *Celery*ë¥¼ ì‚¬ìš©í•  ê²½ìš° ê·¸ ìœ„ì¹˜ì´ê³ , 7ë²ˆì§¸ ì¤„ì€ *celery task*ì— ë„£ì–´ì£¼ëŠ” ëª…ë ¹ì–´ì´ë‹¤.<br>  -> celeryë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ë‘˜ ë‹¤ ì‚­ì œí•´ë²„ë ¤ë„ ë¬´ë°©í•  ë“¯ í•˜ë‹¤.
* 4ë²ˆì§¸ ì¤„ì˜ *slack_api_access_token*ì€ ìœ„ì—ì„œ ë°œê¸‰í•´ ë‘” *Access Token*ì„ strë¡œ ì„¤ì •í•´ ë‘” ë¶€ë¶„ì´ê³ ,
* ê°™ì€ ì¤„ì˜ *slack_post_channel*ì€ postë¥¼ ë³´ë‚¼ ì±„ë„ì˜ url ì£¼ì†Œì´ë‹¤.

<br>
ëŒ€ëµì ìœ¼ë¡œ ì½”ë“œì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë³´ìë©´ ì•„ë˜ì™€ ê°™ë‹¤.

1. ê¸°ë³¸ì ìœ¼ë¡œ 9ë²ˆì§¸ ì¤„ì˜ client = WebClient(token = {Access Token})ì„ í†µí•´ *WebClient* ê°ì²´ë¥¼ ìƒì„± í›„ initialize í•´ ì£¼ê³ ,
2. 10ë²ˆì§¸ ì¤„ì˜ body_rawì²˜ëŸ¼ blocks ì•ˆì„ ë³¸ì¸ì˜ ì…ë§ì— ë§ê²Œ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•œ í›„,
3. *client.chat_postMessage()*ë¡œ í•´ë‹¹ ì±„ë„ì˜ urlê³¼ bodyë¥¼ í•¨ê»˜ postí•´ì£¼ëŠ” ì½”ë“œì´ë‹¤.

<br>
ì •ë‹µì´ ì•„ë‹ ìˆ˜ë„ ìˆì§€ë§Œ, ë‚˜ëŠ” ì´ë ‡ê²Œ ì¼ë‹¤(~~...~~)<br><br>
blocksë¥¼ ë§Œë“œëŠ” ë¶€ë¶„ì€ Slack ë‹µê²Œ ì•¼ë¬´ì§€ê²Œ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ê°€ëŠ¥í•˜ë‹¤. (slackì—ì„œ ì œê³µí•˜ëŠ” [Block Kit Builder](https://app.slack.com/block-kit-builder/T02T1LDJS2U#%7B%22blocks%22:%5B%7B%22type%22:%22section%22,%22text%22:%7B%22type%22:%22mrkdwn%22,%22text%22:%22Hey%20there%20ğŸ‘‹%20I'm%20TaskBot.%20I'm%20here%20to%20help%20you%20create%20and%20manage%20tasks%20in%20Slack.%5CnThere%20are%20two%20ways%20to%20quickly%20create%20tasks:%22%7D%7D,%7B%22type%22:%22section%22,%22text%22:%7B%22type%22:%22mrkdwn%22,%22text%22:%22*1%EF%B8%8Fâƒ£%20Use%20the%20%60/task%60%20command*.%20Type%20%60/task%60%20followed%20by%20a%20short%20description%20of%20your%20tasks%20and%20I'll%20ask%20for%20a%20due%20date%20(if%20applicable).%20Try%20it%20out%20by%20using%20the%20%60/task%60%20command%20in%20this%20channel.%22%7D%7D,%7B%22type%22:%22section%22,%22text%22:%7B%22type%22:%22mrkdwn%22,%22text%22:%22*2%EF%B8%8Fâƒ£%20Use%20the%20_Create%20a%20Task_%20action.*%20If%20you%20want%20to%20create%20a%20task%20from%20a%20message,%20select%20%60Create%20a%20Task%60%20in%20a%20message's%20context%20menu.%20Try%20it%20out%20by%20selecting%20the%20_Create%20a%20Task_%20action%20for%20this%20message%20(shown%20below).%22%7D%7D,%7B%22type%22:%22image%22,%22title%22:%7B%22type%22:%22plain_text%22,%22text%22:%22image1%22,%22emoji%22:true%7D,%22image_url%22:%22https://api.slack.com/img/blocks/bkb_template_images/onboardingComplex.jpg%22,%22alt_text%22:%22image1%22%7D,%7B%22type%22:%22section%22,%22text%22:%7B%22type%22:%22mrkdwn%22,%22text%22:%22â•%20To%20start%20tracking%20your%20team's%20tasks,%20*add%20me%20to%20a%20channel*%20and%20I'll%20introduce%20myself.%20I'm%20usually%20added%20to%20a%20team%20or%20project%20channel.%20Type%20%60/invite%20@TaskBot%60%20from%20the%20channel%20or%20pick%20a%20channel%20on%20the%20right.%22%7D,%22accessory%22:%7B%22type%22:%22conversations_select%22,%22placeholder%22:%7B%22type%22:%22plain_text%22,%22text%22:%22Select%20a%20channel...%22,%22emoji%22:true%7D%7D%7D,%7B%22type%22:%22divider%22%7D,%7B%22type%22:%22context%22,%22elements%22:%5B%7B%22type%22:%22mrkdwn%22,%22text%22:%22ğŸ‘€%20View%20all%20tasks%20with%20%60/task%20list%60%5Cnâ“Get%20help%20at%20any%20time%20with%20%60/task%20help%60%20or%20type%20*help*%20in%20a%20DM%20with%20me%22%7D%5D%7D%5D%7D))
<br><br>
ìœ„ì˜ íˆ´ë¡œ ë³¸ì¸ë§Œì˜ blockì„ ì•¼ë¬´ì§€ê²Œ ê¾¸ë©° ë³´ì.<br>

* ì°¸ê³ ë¡œ ì´ëª¨ì§€ë¥¼ í™œìš©í•˜ë ¤ë©´ ì•„ë˜ì™€ ê°™ì´ "emoji": Trueë¥¼ ë„£ì–´ì£¼ì–´ì•¼ í•˜ê³ , :(ì´ëª¨ì§€ ì´ë¦„): ì™€ ê°™ì´ ì¨ì•¼í•œë‹¤. *~~(ê°œë°œìíŠ¹ : ì´ëª¨í‹°ì½˜ ì´ëŸ°ê±° ì¢‹ì•„í•¨)~~*<br>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type":&nbsp;"header",</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"text":&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type":&nbsp;"plain_text",</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"text":&nbsp;f"Error&nbsp;ë°œìƒ!&nbsp;code&nbsp;:&nbsp;{code}&nbsp;:glitch_crab:",</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"emoji":&nbsp;True</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div><br>

ì—¬ê¸°ê¹Œì§€ ì •ìƒì ìœ¼ë¡œ ì§„í–‰í–ˆë‹¤ë©´, API call í˜¹ì€ Postmanë“±ìœ¼ë¡œ postë¥¼ í•œë²ˆ ë³´ë‚´ ë³´ì.<br><br>
ì•„ì§ ì—ëŸ¬ ë¡œê¹…ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ì„ ë„£ì§„ ì•Šì•˜ìœ¼ë¯€ë¡œ, ì“¸ì“¸í•œ Plain Textë§Œì´ ìš°ë¦¬ë¥¼ ë°˜ê²¨ì¤€ë‹¤. ~~(ë‚˜ëŠ” ì•ˆí•´ë´¤ìœ¼ë¯€ë¡œ ì‚¬ì§„ì€ ë”°ë¡œ ì—†ìŒ)~~<br><br>
ë”°ë¼ì„œ ì´ì œ *djangoì˜ exception handler*ì™€ ë³¸ì¸ë§Œì˜ *ì—ëŸ¬ì²˜ë¦¬ ë¡œì§*ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•´ ì›í•˜ëŠ” ì—ëŸ¬ë“¤ì„ Slackìœ¼ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆê²Œë” ë§Œë“¤ì–´ ë³´ì.
<br><br>

# 3. Exception Handling
ì‚¬ì‹¤ ***ì—ëŸ¬ ì²˜ë¦¬***ëŠ” ë°©ë²•ì´ ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥´ê³ , ë§¤ìš° ë‹¤ì–‘í•˜ë‹¤.<br>

1. DRFì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” Http404Response ë“±ì„ í™œìš©í•˜ê±°ë‚˜,
2. ë‹¨ìˆœ HTTP status codeì™€ detailë§Œì„ Returní•  ìˆ˜ë„ ìˆê³ ,
3. ì—ëŸ¬ì½”ë“œ ë“±ì„ ì§ì ‘ ì •ì˜í•´ ë¬¸ì„œë¥¼ ë§Œë“  í›„ ì´ë¥¼ í†µí•´ í”„ë¡ íŠ¸ì™€ ì†Œí†µí•˜ëŠ” ë°©ë²• ë“±

íšŒì‚¬ì— ë§ê²Œ, ê°œë°œìì— ë§ê²Œ ë„ˆë¬´ ë‹¤ì–‘í•œ ë°©ë²•ì´ ìˆë‹¤.<br>

ë‚˜ì˜ ê²½ìš°ì—” 3~4ìë¦¬ì˜ ì •ìˆ˜ë¥¼ ì½”ë“œë¡œ ì •ì˜í•´ ì´ì— ë§ê²Œ 20x 40xë¥¼ JSONResponseë¡œ Returní•´ ì£¼ëŠ”ë°,<br>
ì˜¤ëŠ˜ì˜ ê²½ìš°ì—” *ë°ì´í„° ë¬´ê²°ì„± ì´ìƒ*ì´ë‚˜ *í† í° ë³€ì¡°*, *ì„œë²„ ì—ëŸ¬* ë“± (401, 403, 50x ë“±?) ë”°ë¡œ ëª¨ë‹ˆí„°ë§ì´ í•„ìš”í•œ ë¶€ë¶„ë“¤ë§Œ ëª¨ì•„ Slackìœ¼ë¡œ ë³´ë‚´ë³´ë ¤ê³  í•œë‹¤.<br><br>
(ì‚¬ì‹¤ ì´ë¯¸ *AWS CloudWatch*ë¥¼ í†µí•´ ì´ëŸ° ì—ëŸ¬ë“¤ì„ ë¡œê¹…í•˜ê³  ìˆì§€ë§Œ, Slackì€ í•¸ë“œí°ì— ì•Œë¦¼ì´ ë„ì°©í•˜ë¯€ë¡œ, ê·¸ ìš©ë„ë¡œ ì‚¬ìš©í•˜ë ¤ê³  í•œë‹¤)<br><br>

ê°ì„¤í•˜ê³ , ì ë‹¹í•œ ìœ„ì¹˜ì— *custom exception handler*ë¥¼ ìƒì„±í•´ ì£¼ì.<br>
*Django*ì˜ ê¸°ë³¸ *exception handler*ë¥¼ ì ë‹¹íˆ ì»¤ìŠ¤í…€í•´, ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.<br>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;rest_framework.views&nbsp;<span style="color:#a71d5d">import</span>&nbsp;exception_handler</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;rest_framework&nbsp;<span style="color:#a71d5d">import</span>&nbsp;status</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;{somewhere_error_response_exists}&nbsp;<span style="color:#a71d5d">import</span>&nbsp;failure_response</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;{somewhere_error_code_exists}&nbsp;<span style="color:#a71d5d">import</span>&nbsp;unhandled_error_code</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">def</span>&nbsp;custom_exception_handler(exc,&nbsp;request):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;exception_handler(exc,&nbsp;request)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>&nbsp;response&nbsp;<span style="color:#a71d5d">is</span>&nbsp;<span style="color:#a71d5d">not</span>&nbsp;<span style="color:#066de2">None</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>&nbsp;status.is_server_error(response.status_code)&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#066de2">True</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">return</span>&nbsp;failure_response(request,&nbsp;unhandled_error_code,&nbsp;exc)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">return</span>&nbsp;response</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">return</span>&nbsp;failure_response(request,&nbsp;unhandled_error_code,&nbsp;exc)</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div><br>

ë‹¤ë¥¸ ë¶€ë¶„ì€ í° ì˜ë¯¸ëŠ” ì—†ê³ ,
1. 11ë²ˆì§¸ ì¤„ì„ í†µí•´ *HTTP 50x*ë¥¼ íŒë³„í•´ ë”°ë¡œ ì •ì˜í•´ ë‘” unhandled_error_codeë¥¼ ë‹´ì•„ ë„˜ê²¨ì£¼ê³ ,
2. *ë‚´ê°€ ì§ì ‘ raiseí•œ ì—ëŸ¬*ê°€ ì•„ë‹ˆë©´ 15ë²ˆì§¸ ì¤„ì„ í†µí•´ ì—­ì‹œ unhandled_error_codeë¥¼ ë‹´ì•„ ë³´ë‚´ì¤€ë‹¤.

12, 15ë²ˆì§¸ ì¤„ê³¼ ê°™ì´ ëª¨ë“  ì—ëŸ¬ ì²˜ë¦¬ì— requestì™€ excë¥¼ í•¨ê»˜ ë‹´ì•„ ë³´ë‚´ì£¼ë©´, ìœ„ì˜ chatMessageì—ì„œ ë§Œë“¤ì–´ ì¤€ blockë¥¼ ì¢€ ë” ì •ë³´ê°€ ê°€ë“í•˜ê²Œ ê¾¸ë©°ì¤„ ìˆ˜ ìˆë‹¤!<br><br>
ê·¸ëŸ¼ ì´ì œ ì—ëŸ¬ë¥¼ responseí•˜ëŠ” ë¶€ë¶„ì„ ë“¤ì—¬ë‹¤ë³´ì.
<br><br>

# 4. Error Response, Logging
ê°ìì˜ ì—ëŸ¬ ì²˜ë¦¬ í•¨ìˆ˜ë¥¼ ë“¤ì—¬ë‹¤ë³´ì. í˜„ì¬ ë‚´ê°€ ì‚¬ìš©ì¤‘ì¸ ì—ëŸ¬ ì²˜ë¦¬ í•¨ìˆ˜ë¥¼ (ë§¤ìš°) ê°„ëµí™”í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.<br>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;{somewhere_error_code_exists}&nbsp;<span style="color:#a71d5d">import</span>&nbsp;unhandled_error_code</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;{somewhere_def_exists}&nbsp;<span style="color:#a71d5d">import</span>&nbsp;slack_error_post</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">def</span>&nbsp;failure_response(request,&nbsp;code,&nbsp;exc<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#066de2">None</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>&nbsp;code&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;unhandled_error_code:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slack_error_post.apply_async(\</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#63a35c">"your_queue"</span>,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwargs<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>{\</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#63a35c">'message'</span>:&nbsp;<span style="color:#63a35c">"your_message"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#63a35c">'exc'</span>:&nbsp;f<span style="color:#63a35c">'{exc}'</span>}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">return</span>&nbsp;JsonResponse({<span style="color:#63a35c">"message"</span>:&nbsp;<span style="color:#63a35c">"blahblah"</span>},&nbsp;status<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>status_code)</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div><br>

ë‚´ê°€ í™œìš©í•  ë¶€ë¶„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
1. exception handlerì—ì„œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©° ê°™ì´ ë‹´ì•„ì¤€ *request*ì™€ *exc*ë¥¼ ë°›ì•„, ê°€ê³µí•´ ì¤€ë‹¤.
2. ì—¬ëŸ¬ ì ˆì°¨ë¥¼ í†µí•´ 5~11ë²ˆì§¸ ì¤„ê³¼ ê°™ì´ kwargsì— ì—ëŸ¬ ì •ë³´ë¥¼ ë‹´ì•„ ë¹„ë™ê¸°ë¡œ Slackì— post ìš”ì²­ì„ ë³´ë‚¸ë‹¤.
3. ì´í›„ ì ë‹¹íˆ ìœ ì €ì—ê²Œ ë³´ì—¬ì¤„ responseë¥¼ ìƒì„± í›„ Return í•œë‹¤.

ì´í›„ ì²˜ìŒì— ë§Œë“¤ì–´ ì¤€ slack_error_postì˜ bodyì—ì„œ *request.path_info*ë‚˜ *exc.detail*ë“± ì—¬ëŸ¬ ì •ë³´ë¥¼ ë°›ì•„, blockì„ ìƒì„±í•´ ì¤€ë‹¤.
<br><br>

# 5. ê²°ê³¼ë¬¼
ë‚˜ëŠ” ì´ëª¨í‹°ì½˜ê³¼ request, exc ì •ë³´ë¥¼ í™œìš©í•´ blockì„ ê¾¸ëª„ê³ , errorê°€ postë˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë©”ì‹œì§€ê°€ ë„ì°©í•œë‹¤.<br><br>
![slack message](https://drive.google.com/uc?id=1-hzqsDZvzGHQn2e6-PWP2NvT3Owhfc0S)

*~~(ê½‚ê²Œê°€ ê¸°ì–´ë‹¤ë‹ˆê³ , ì‚¬ì´ë Œì´ ìš¸ë¦¬ê³ , ìœ ë ¹ì´ ë†€ë¦¬ê³ , ë¼ì§€ê°€ ê±¸ì–´ê°€ê³ ,,,,)~~*

íšŒì‚¬ì—ì„œ ì‹¤ì œë¡œ ë°œìƒí•œ ì—ëŸ¬ ë‚´ìš©ì´ë‹¤ë³´ë‹ˆ ì§€ì›Œì§„ ë‚´ìš©ì´ ë” ë§ì§€ë§Œ,<br>
ìœ„ì™€ ê°™ì´ ***ì–´ë–¤ ìœ ì €***ê°€ ***ì–´ë–¤ ê²½ë¡œì—ì„œ***, ***ì–´ë–¤ ì—ëŸ¬***ë¥¼ ì¼ìœ¼ì¼°ëŠ”ì§€ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.<br>

ì´ë ‡ê²Œ êµ¬í˜„í•œ ì—ëŸ¬ ì²˜ë¦¬ ë°©ë²•ê³¼ ë¡œê¹… ë°©ì‹ì´ ì •ë‹µì€ ì•„ë‹ ìˆ˜ ìˆì§€ë§Œ, ë‚˜ëŠ” ìœ„ì²˜ëŸ¼ êµ¬í˜„í•˜ê³  ì»¤ìŠ¤í„°ë§ˆì´ì§•í•´ ì£¼ë©° ì•„ì§ê¹Œì§€ ì˜ í™œìš©í•˜ê³  ìˆë‹¤!<br><br>
ë. ë‚¨ì€ ì–´ë¦°ì´ë‚ ... ë†€ëŸ¬ê°€ì•¼ì§•